{"ast":null,"code":"import React,{useEffect,useMemo,useRef,useState}from'react';import classNames from'classnames';import{UserWarning}from'./utils/UserWarning';import{createTodo,getTodos,updateTodo}from'./api/todos';import{Status}from'./types/Status';import{TodoList}from'./components/TodoList';import{TodosFilter}from'./components/TodoFilter';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const USER_ID=11408;export const App=()=>{const[todos,setTodos]=useState([]);const[status,setStatus]=useState(Status.all);const[errorMessage,setErrorMessage]=useState('');const[value,setValue]=useState('');const[tempTodo,setTempTodo]=useState(null);const inputRef=useRef(null);const allTodosCompleted=useMemo(()=>todos.every(todo=>todo.completed),[todos]);useEffect(()=>{var _inputRef$current;(_inputRef$current=inputRef.current)===null||_inputRef$current===void 0?void 0:_inputRef$current.focus();},[todos.length,errorMessage]);useEffect(()=>{const timer=setTimeout(()=>{setErrorMessage('');},3000);return()=>clearTimeout(timer);},[errorMessage]);useEffect(()=>{getTodos(USER_ID).then(setTodos).catch(()=>{setErrorMessage('Unable to load todos');});},[]);if(!USER_ID){return/*#__PURE__*/_jsx(UserWarning,{});}const handleSubmit=event=>{event.preventDefault();setErrorMessage('');if(!value.trim()){setErrorMessage('Title should not be empty');}else{setTempTodo({userId:USER_ID,title:value.trim(),completed:false,id:0});createTodo({userId:USER_ID,title:value.trim(),completed:false}).then(newItem=>{setTodos(currentTodos=>[...currentTodos,newItem]);setValue('');}).catch(()=>{setErrorMessage('Unable to add a todo');}).finally(()=>{setTempTodo(null);});}};const handleToggleAll=()=>{const promiseArray=todos.map(todo=>updateTodo(todo.id,{completed:!allTodosCompleted}));Promise.all(promiseArray).then(()=>{setTodos(prevTodos=>prevTodos.map(item=>({...item,completed:!allTodosCompleted})));}).catch(()=>{setErrorMessage('Unable to change status, refresh page');});};return/*#__PURE__*/_jsxs(\"div\",{className:\"todoapp\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"todoapp__title\",children:\"todos\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"todoapp__content\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"todoapp__header\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:classNames('todoapp__toggle-all',{active:allTodosCompleted}),\"data-cy\":\"ToggleAllButton\",\"aria-label\":\"toggle all\",onClick:handleToggleAll}),/*#__PURE__*/_jsx(\"form\",{onSubmit:handleSubmit,children:/*#__PURE__*/_jsx(\"input\",{\"data-cy\":\"NewTodoField\",type:\"text\",className:\"todoapp__new-todo\",placeholder:\"What needs to be done?\",value:value,onChange:event=>setValue(event.target.value),ref:inputRef,disabled:tempTodo!==null})})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"todoapp__main\",\"data-cy\":\"TodoList\",children:[/*#__PURE__*/_jsx(TodoList,{todos:todos,status:status,setTodos:setTodos,setErrorMessage:setErrorMessage}),tempTodo&&/*#__PURE__*/_jsxs(\"div\",{\"data-cy\":\"Todo\",className:\"todo\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"todo__status-label\",children:/*#__PURE__*/_jsx(\"input\",{\"data-cy\":\"TodoStatus\",type:\"checkbox\",className:\"todo__status\"})}),/*#__PURE__*/_jsx(\"span\",{\"data-cy\":\"TodoTitle\",className:\"todo__title\",children:tempTodo.title}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"todo__remove\",\"data-cy\":\"TodoDelete\",\"aria-label\":\"Delete\",children:\"\\xD7\"}),/*#__PURE__*/_jsxs(\"div\",{\"data-cy\":\"TodoLoader\",className:\"modal overlay is-active\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"modal-background has-background-white-ter\"}),/*#__PURE__*/_jsx(\"div\",{className:\"loader\"})]})]})]}),!!todos.length&&/*#__PURE__*/_jsx(TodosFilter,{todos:todos,setTodos:setTodos,status:status,setStatus:setStatus,setErrorMessage:setErrorMessage})]}),/*#__PURE__*/_jsxs(\"div\",{\"data-cy\":\"ErrorNotification\",className:classNames('notification is-danger is-light has-text-weight-normal',{hidden:!errorMessage}),children:[/*#__PURE__*/_jsx(\"button\",{\"data-cy\":\"HideErrorButton\",type:\"button\",className:\"delete\",\"aria-label\":\"Hide Error\",onClick:()=>setErrorMessage('')}),errorMessage]})]});};","map":{"version":3,"names":["React","useEffect","useMemo","useRef","useState","classNames","UserWarning","createTodo","getTodos","updateTodo","Status","TodoList","TodosFilter","jsx","_jsx","jsxs","_jsxs","USER_ID","App","todos","setTodos","status","setStatus","all","errorMessage","setErrorMessage","value","setValue","tempTodo","setTempTodo","inputRef","allTodosCompleted","every","todo","completed","_inputRef$current","current","focus","length","timer","setTimeout","clearTimeout","then","catch","handleSubmit","event","preventDefault","trim","userId","title","id","newItem","currentTodos","finally","handleToggleAll","promiseArray","map","Promise","prevTodos","item","className","children","type","active","onClick","onSubmit","placeholder","onChange","target","ref","disabled","hidden"],"sources":["/Users/admin/Projects/TODO-app/src/App.tsx"],"sourcesContent":["import React, {\n  useEffect, useMemo, useRef, useState,\n} from 'react';\nimport classNames from 'classnames';\nimport { UserWarning } from './utils/UserWarning';\nimport { createTodo, getTodos, updateTodo } from './api/todos';\nimport { Todo } from './types/Todo';\nimport { Status } from './types/Status';\nimport { TodoList } from './components/TodoList';\nimport { TodosFilter } from './components/TodoFilter';\n\nconst USER_ID = 11408;\n\nexport const App: React.FC = () => {\n  const [todos, setTodos] = useState<Todo[]>([]);\n  const [status, setStatus] = useState(Status.all);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [value, setValue] = useState('');\n  const [tempTodo, setTempTodo] = useState<Todo | null>(null);\n\n  const inputRef = useRef<HTMLInputElement | null>(null);\n\n  const allTodosCompleted = useMemo(\n    () => todos.every((todo: Todo) => todo.completed),\n    [todos],\n  );\n\n  useEffect(() => {\n    inputRef.current?.focus();\n  }, [todos.length, errorMessage]);\n\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      setErrorMessage(\n        '',\n      );\n    }, 3000);\n\n    return () => clearTimeout(timer);\n  }, [errorMessage]);\n\n  useEffect(() => {\n    getTodos(USER_ID)\n      .then(setTodos)\n      .catch(() => {\n        setErrorMessage('Unable to load todos');\n      });\n  }, []);\n\n  if (!USER_ID) {\n    return <UserWarning />;\n  }\n\n  const handleSubmit = (event: React.FormEvent) => {\n    event.preventDefault();\n\n    setErrorMessage('');\n\n    if (!value.trim()) {\n      setErrorMessage('Title should not be empty');\n    } else {\n      setTempTodo({\n        userId: USER_ID, title: value.trim(), completed: false, id: 0,\n      });\n\n      createTodo({ userId: USER_ID, title: value.trim(), completed: false })\n        .then(newItem => {\n          setTodos(currentTodos => [...currentTodos, newItem]);\n          setValue('');\n        })\n        .catch(() => {\n          setErrorMessage('Unable to add a todo');\n        })\n        .finally(() => {\n          setTempTodo(null);\n        });\n    }\n  };\n\n  const handleToggleAll = () => {\n    const promiseArray = todos.map(\n      todo => updateTodo(todo.id, { completed: !allTodosCompleted }),\n    );\n\n    Promise.all(promiseArray)\n      .then(() => {\n        setTodos(prevTodos => prevTodos.map(\n          item => ({ ...item, completed: !allTodosCompleted }),\n        ));\n      })\n      .catch(() => {\n        setErrorMessage('Unable to change status, refresh page');\n      });\n  };\n\n  return (\n    <div className=\"todoapp\">\n      <h1 className=\"todoapp__title\">todos</h1>\n\n      <div className=\"todoapp__content\">\n        <header className=\"todoapp__header\">\n          <button\n            type=\"button\"\n            className={classNames(\n              'todoapp__toggle-all',\n              {\n                active: allTodosCompleted,\n              },\n            )}\n            data-cy=\"ToggleAllButton\"\n            aria-label=\"toggle all\"\n            onClick={handleToggleAll}\n          />\n\n          <form onSubmit={handleSubmit}>\n            <input\n              data-cy=\"NewTodoField\"\n              type=\"text\"\n              className=\"todoapp__new-todo\"\n              placeholder=\"What needs to be done?\"\n              value={value}\n              onChange={(event) => setValue(event.target.value)}\n              ref={inputRef}\n              disabled={tempTodo !== null}\n            />\n          </form>\n        </header>\n\n        <section className=\"todoapp__main\" data-cy=\"TodoList\">\n          <TodoList\n            todos={todos}\n            status={status}\n            setTodos={setTodos}\n            setErrorMessage={setErrorMessage}\n          />\n          {tempTodo && (\n            <div\n              data-cy=\"Todo\"\n              className=\"todo\"\n            >\n              <label\n                className=\"todo__status-label\"\n              >\n                <input\n                  data-cy=\"TodoStatus\"\n                  type=\"checkbox\"\n                  className=\"todo__status\"\n                />\n              </label>\n\n              <span\n                data-cy=\"TodoTitle\"\n                className=\"todo__title\"\n              >\n                {tempTodo.title}\n              </span>\n\n              <button\n                type=\"button\"\n                className=\"todo__remove\"\n                data-cy=\"TodoDelete\"\n                aria-label=\"Delete\"\n              >\n                Ã—\n              </button>\n\n              <div\n                data-cy=\"TodoLoader\"\n                className=\"modal overlay is-active\"\n              >\n                <div className=\"modal-background has-background-white-ter\" />\n                <div className=\"loader\" />\n              </div>\n\n            </div>\n          )}\n        </section>\n\n        {!!todos.length && (\n          <TodosFilter\n            todos={todos}\n            setTodos={setTodos}\n            status={status}\n            setStatus={setStatus}\n            setErrorMessage={setErrorMessage}\n          />\n        )}\n\n      </div>\n\n      <div\n        data-cy=\"ErrorNotification\"\n        className={classNames(\n          'notification is-danger is-light has-text-weight-normal',\n          {\n            hidden: !errorMessage,\n          },\n        )}\n      >\n        <button\n          data-cy=\"HideErrorButton\"\n          type=\"button\"\n          className=\"delete\"\n          aria-label=\"Hide Error\"\n          onClick={() => setErrorMessage(\n            '',\n          )}\n        />\n        {errorMessage}\n      </div>\n    </div>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}